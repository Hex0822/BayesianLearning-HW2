---
title: "Assignment2"
author: "Tianyi Zhang"
format: html
---

## Problem 5

### Problem 5a)

```{r}
data = read.csv("https://github.com/mattiasvillani/BayesLearnCourse/raw/master/assignment/bugs.csv", 
                header = TRUE)
y = data$nBugs # response variable: the number of bugs, a vector with n = 91 observations
X = data[,-1]  # 91 x 5 matrix with covariates
X = as.matrix(X) # X was initially a data frame, but we want it to be matrix
head(X)

```


```{r}
library(mvtnorm)
tau_sq = 100

logPostPois = function(beta,X,y,tau_sq){
  Prior = dmvnorm(beta,mean=rep(0,length(beta)),sigma = tau_sq*diag(length(beta)),log = TRUE)
  #Likelihood = sum(y*X%*%beta-exp(X%*%beta)-lgamma(y+1))
  loglike = sum(dpois(y,lambda = exp(X%*%beta),log=TRUE))
  Posterior = Prior+loglike
  return(Posterior)
}

# optim finds the minimum by default
# fnsclae=-1 means we are doing maximum
opt = optim(par = rep(0,5),
            fn=logPostPois,
            gr = NULL,
            X=X,y=y,tau_sq=tau_sq,
            method = "BFGS",
            control= list(fnscale=-1),
            hessian=TRUE)

mu_posterior = opt$par
Sigma_posterior = solve(opt$hessian)

mu_posterior
# > mu_posterior
# [1] -1.105291427 -0.009578895  1.444598369  3.181445388  2.143179057
Sigma_posterior

```


### Problem 5b)

```{r}


```
